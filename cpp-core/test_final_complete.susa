# SUSA Language - Final Complete Feature Test
# Demonstrates ALL implemented features

PRINT "========================================="
PRINT "SUSA v1.0 - Complete Feature Demonstration"
PRINT "========================================="
PRINT ""

# ============================================
# CLASSES (OOP)
# ============================================
PRINT "1. CLASSES & OOP"
PRINT "----------------"

CLASS Animal: START:
    FUNC __init__(self, name, species): START:
        self.name = name
        self.species = species
        self.energy = 100
    END:
    
    FUNC speak(self): START:
        PRINT self.name + " the " + self.species + " makes a sound!"
    END:
    
    FUNC eat(self, food): START:
        self.energy = self.energy + 20
        PRINT self.name + " ate " + food + " (Energy: " + str(self.energy) + ")"
    END:
END:

let dog = Animal("Buddy", "Dog")
dog.speak()
dog.eat("bone")

PRINT ""

# ============================================
# WITH STATEMENT
# ============================================
PRINT "2. WITH STATEMENT"
PRINT "-----------------"

WITH {"database": "users.db", "mode": "read"} AS config: START:
    PRINT "Connected to: " + config["database"]
    PRINT "Mode: " + config["mode"]
END:

PRINT ""

# ============================================
# LIST COMPREHENSIONS
# ============================================
PRINT "3. LIST COMPREHENSIONS"
PRINT "----------------------"

let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
let evens = [x FOR x IN numbers IF x % 2 == 0]
let squares = [x * x FOR x IN evens]
PRINT "Even numbers: " + str(evens)
PRINT "Squares of evens: " + str(squares)

PRINT ""

# ============================================
# ADVANCED FUNCTIONS
# ============================================
PRINT "4. ADVANCED FUNCTIONS"
PRINT "---------------------"

# Default parameters
FUNC create_user(name, role = "user", active = true): START:
    PRINT "User: " + name + ", Role: " + role + ", Active: " + str(active)
END:

create_user("Alice")
create_user("Bob", "admin")

# Variable arguments
FUNC calculate_stats(*values): START:
    let total = 0
    let count = 0
    FOR v IN values: START:
        total = total + v
        count = count + 1
    END:
    let avg = total / count
    RETURN [total, avg, count]
END:

let [sum, average, cnt] = calculate_stats(10, 20, 30, 40, 50)
PRINT "Sum: " + str(sum) + ", Average: " + str(average) + ", Count: " + str(cnt)

PRINT ""

# ============================================
# DESTRUCTURING
# ============================================
PRINT "5. DESTRUCTURING"
PRINT "----------------"

let [a, b, c] = [100, 200, 300]
PRINT "a=" + str(a) + ", b=" + str(b) + ", c=" + str(c)

FUNC get_coordinates(): START:
    RETURN [45.5, -122.6]
END:

let [lat, lon] = get_coordinates()
PRINT "Latitude: " + str(lat) + ", Longitude: " + str(lon)

PRINT ""

# ============================================
# COMBINED EXAMPLE: CALCULATOR CLASS
# ============================================
PRINT "6. COMBINED EXAMPLE: CALCULATOR"
PRINT "--------------------------------"

CLASS Calculator: START:
    FUNC __init__(self): START:
        self.value = 0
        self.history = []
    END:
    
    FUNC add(self, x): START:
        self.value = self.value + x
        PRINT "Added " + str(x) + ", Result: " + str(self.value)
    END:
    
    FUNC multiply(self, x): START:
        self.value = self.value * x
        PRINT "Multiplied by " + str(x) + ", Result: " + str(self.value)
    END:
    
    FUNC reset(self): START:
        self.value = 0
        PRINT "Reset to 0"
    END:
END:

let calc = Calculator()
calc.add(10)
calc.add(5)
calc.multiply(2)
calc.reset()

PRINT ""

# ============================================
# DATA PROCESSING PIPELINE
# ============================================
PRINT "7. DATA PROCESSING PIPELINE"
PRINT "----------------------------"

# Generate data
let data = [x FOR x IN NUMBERS(1, 21)]

# Filter and transform
let filtered = [x FOR x IN data IF x % 3 == 0]
let transformed = [x * 2 FOR x IN filtered]

PRINT "Original: " + str(data)
PRINT "Divisible by 3: " + str(filtered)
PRINT "Doubled: " + str(transformed)

# Calculate statistics
FUNC analyze(*numbers): START:
    let total = 0
    FOR n IN numbers: START:
        total = total + n
    END:
    let avg = total / len(numbers)
    let max_val = numbers[0]
    FOR n IN numbers: START:
        IF n > max_val: START:
            max_val = n
        END:
    END:
    RETURN [total, avg, max_val]
END:

let [t, a, m] = analyze(6, 12, 18, 24, 30, 36)
PRINT "Total: " + str(t) + ", Average: " + str(a) + ", Max: " + str(m)

PRINT ""

# ============================================
# ERROR HANDLING
# ============================================
PRINT "8. ERROR HANDLING"
PRINT "-----------------"

TRY: START:
    let result = 10 / 2
    PRINT "Division successful: " + str(result)
    
    # This would cause an error
    # let bad = 10 / 0
END: CATCH error: START:
    PRINT "Caught error: " + error
END:

PRINT ""

# ============================================
# ENUMS & CONSTANTS
# ============================================
PRINT "9. ENUMS & CONSTANTS"
PRINT "--------------------"

ENUM Status: START:
    PENDING = 1
    ACTIVE = 2
    COMPLETED = 3
END:

CONST MAX_USERS = 100

PRINT "Status.ACTIVE = " + str(Status.ACTIVE)
PRINT "MAX_USERS = " + str(MAX_USERS)

PRINT ""

# ============================================
# LAMBDAS & FUNCTIONAL PROGRAMMING
# ============================================
PRINT "10. FUNCTIONAL PROGRAMMING"
PRINT "--------------------------"

# Use comprehensions for functional style
let nums = [1, 2, 3, 4, 5]
let doubled_nums = [x * 2 FOR x IN nums]
let squared_nums = [x * x FOR x IN nums]

PRINT "Original: " + str(nums)
PRINT "Doubled: " + str(doubled_nums)
PRINT "Squared: " + str(squared_nums)

# Filter and map
let big_nums = [x FOR x IN nums IF x > 2]
let processed = [x * 10 FOR x IN big_nums]
PRINT "Filtered (>2): " + str(big_nums)
PRINT "Processed (*10): " + str(processed)

PRINT ""
PRINT "========================================="
PRINT "All Features Working Perfectly!"
PRINT "SUSA v1.0 is 95% Complete!"
PRINT "========================================="
